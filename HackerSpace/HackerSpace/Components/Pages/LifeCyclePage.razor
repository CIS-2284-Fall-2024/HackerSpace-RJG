@page "/lifecycle/{index:int}"
@attribute [StreamRendering(true)]

<h3>Life Cyle Demo</h3>

@if(messages == null)
{
    <p>Loading...</p>
}
else
{
    <ul>
        @foreach (var message in messages)
        {
            <li>@message</li>
        }
    </ul>
}

<p>
    Index: @Index
</p>
<p>
    Index at start: @indexAtStart
</p>

@code {
    private List<string>? messages;

    [Parameter]
    public int Index { get; set; }

    private int? indexAtStart;

    protected async override Task OnParametersSetAsync()
    {
        indexAtStart = Index;
    }


    protected async override Task OnInitializedAsync()
    {        
        messages = new List<string>();
        messages.Add("OnInitializedAsync 1");
        messages.Add("OnInitializedAsync 2");
        messages.Add("OnInitializedAsync 3");
    }

    protected  async override Task OnAfterRenderAsync(bool firstRender)
    {
        if(firstRender)
        {
            messages.Add("First render!");
            StateHasChanged();
        }
        else
        {
            messages.Add("Not first render!");
            StateHasChanged();
        }
    }

}
